<div class="filters">
  <mat-form-field appearance="fill" class="search">
    <mat-label>Search title</mat-label>
    <input
      matInput
      type="search"
      [value]="search"
      (input)="onSearch($any($event.target).value)"
      placeholder="e.g. Two Sum"
    />
    <button
      *ngIf="search"
      mat-icon-button
      matSuffix
      aria-label="Clear search"
      (click)="onSearch('')"
    >
      <mat-icon>close</mat-icon>
    </button>
  </mat-form-field>

  <mat-form-field appearance="fill" class="difficulty">
    <mat-label>Difficulty</mat-label>
    <mat-select [value]="selectedDifficulty" (selectionChange)="onDifficultyChange($event.value)">
      <mat-option [value]="''">All</mat-option>
      <mat-option *ngFor="let d of difficulties" [value]="d">{{ d }}</mat-option>
    </mat-select>
  </mat-form-field>

  <button
    mat-stroked-button
    class="clear"
    (click)="clearFilters()"
    [disabled]="!search && !selectedDifficulty"
  >
    Clear
  </button>
</div>

<table
  mat-table
  [dataSource]="problemsDS"
  matSort
  class="problems-table"
  aria-label="Problems"
>
  <!-- Title -->
  <ng-container matColumnDef="title">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Title</th>
    <td mat-cell *matCellDef="let row">{{ row.title }}</td>
  </ng-container>

  <!-- Tags -->
  <ng-container matColumnDef="tags">
    <th mat-header-cell *matHeaderCellDef>Tags</th>
    <td mat-cell *matCellDef="let row">
      <app-tag-chip *ngFor="let t of row.tags; trackBy: trackByTag" [tag]="t"></app-tag-chip>
    </td>
  </ng-container>

  <!-- Difficulty -->
  <ng-container matColumnDef="difficulty">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Difficulty</th>
    <td mat-cell *matCellDef="let row">
      <app-difficulty-pill [difficulty]="row.difficulty"></app-difficulty-pill>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

  <!-- Empty state -->
  <tr class="no-data" mat-row *matNoDataRow>
    <td class="no-data-cell" [attr.colspan]="displayedColumns.length">
      No problems match your filters.
    </td>
  </tr>
</table>

<mat-paginator
  [length]="problemsDS?.filteredData?.length || 0"
  [pageSize]="10"
  [pageSizeOptions]="[5, 10, 25, 50]"
  showFirstLastButtons
  aria-label="Problems paginator"
></mat-paginator>
